{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nlet BooksComponent = class BooksComponent {\n  constructor(bookService, loanService, router) {\n    this.bookService = bookService;\n    this.loanService = loanService;\n    this.router = router;\n    this.books = [];\n    this.filteredBooks = [];\n    this.searchQuery = '';\n    this.loading = true;\n    this.isLoaning = false;\n    this.errorMessage = '';\n    this.successMessage = '';\n  }\n  ngOnInit() {\n    this.loadBooks();\n  }\n  loadBooks() {\n    this.bookService.getAllBooks().subscribe(response => {\n      this.books = response.books || response;\n      this.filteredBooks = this.books;\n      this.loading = false;\n    }, error => {\n      console.log('Error carregant llibres', error);\n      this.errorMessage = error.error.message || 'Error carregant els llibres';\n      this.loading = false;\n    });\n  }\n  filterBooks() {\n    if (!this.searchQuery.trim()) {\n      this.filteredBooks = this.books;\n      return;\n    }\n    const query = this.searchQuery.toLowerCase();\n    this.filteredBooks = this.books.filter(book => book.title.toLowerCase().includes(query) || book.author.toLowerCase().includes(query));\n  }\n  borrowBook(bookId) {\n    this.isLoaning = true;\n    this.errorMessage = '';\n    this.successMessage = '';\n    this.loanService.createLoan(bookId).subscribe(response => {\n      this.isLoaning = false;\n      this.successMessage = 'Préstec solicitat correctament!';\n      setTimeout(() => {\n        this.loadBooks();\n        this.successMessage = '';\n      }, 2000);\n    }, error => {\n      this.isLoaning = false;\n      this.errorMessage = error.error.message || 'Error solicitant el préstec';\n    });\n  }\n  goHome() {\n    this.router.navigate(['/home']);\n  }\n};\nBooksComponent = __decorate([Component({\n  selector: 'app-books',\n  templateUrl: './books.component.html',\n  styleUrls: ['./books.component.css']\n})], BooksComponent);\nexport { BooksComponent };","map":{"version":3,"names":["Component","BooksComponent","constructor","bookService","loanService","router","books","filteredBooks","searchQuery","loading","isLoaning","errorMessage","successMessage","ngOnInit","loadBooks","getAllBooks","subscribe","response","error","console","log","message","filterBooks","trim","query","toLowerCase","filter","book","title","includes","author","borrowBook","bookId","createLoan","setTimeout","goHome","navigate","__decorate","selector","templateUrl","styleUrls"],"sources":["C:\\Users\\efren\\OneDrive\\Escriptori\\Enginyeria de llocs web\\Pract2_Costas\\frontend\\src\\app\\components\\books\\books.component.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { BookService } from '@services/BookService';\r\nimport { LoanService } from '@services/LoanService';\r\n\r\n@Component({\r\n  selector: 'app-books',\r\n  templateUrl: './books.component.html',\r\n  styleUrls: ['./books.component.css']\r\n})\r\nexport class BooksComponent implements OnInit {\r\n  books: any[] = [];\r\n  filteredBooks: any[] = [];\r\n  searchQuery: string = '';\r\n  loading: boolean = true;\r\n  isLoaning: boolean = false;\r\n  errorMessage: string = '';\r\n  successMessage: string = '';\r\n\r\n  constructor(\r\n    private bookService: BookService,\r\n    private loanService: LoanService,\r\n    private router: Router\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.loadBooks();\r\n  }\r\n\r\n  loadBooks(): void {\r\n    this.bookService.getAllBooks().subscribe(\r\n      (response: any) => {\r\n        this.books = response.books || response;\r\n        this.filteredBooks = this.books;\r\n        this.loading = false;\r\n      },\r\n      (error: any) => {\r\n        console.log('Error carregant llibres', error);\r\n        this.errorMessage = error.error.message || 'Error carregant els llibres';\r\n        this.loading = false;\r\n      }\r\n    );\r\n  }\r\n\r\n  filterBooks(): void {\r\n    if (!this.searchQuery.trim()) {\r\n      this.filteredBooks = this.books;\r\n      return;\r\n    }\r\n\r\n    const query = this.searchQuery.toLowerCase();\r\n    this.filteredBooks = this.books.filter(book =>\r\n      book.title.toLowerCase().includes(query) ||\r\n      book.author.toLowerCase().includes(query)\r\n    );\r\n  }\r\n\r\n  borrowBook(bookId: string): void {\r\n    this.isLoaning = true;\r\n    this.errorMessage = '';\r\n    this.successMessage = '';\r\n\r\n    this.loanService.createLoan(bookId).subscribe(\r\n      (response: any) => {\r\n        this.isLoaning = false;\r\n        this.successMessage = 'Préstec solicitat correctament!';\r\n        setTimeout(() => {\r\n          this.loadBooks();\r\n          this.successMessage = '';\r\n        }, 2000);\r\n      },\r\n      (error: any) => {\r\n        this.isLoaning = false;\r\n        this.errorMessage = error.error.message || 'Error solicitant el préstec';\r\n      }\r\n    );\r\n  }\r\n\r\n  goHome(): void {\r\n    this.router.navigate(['/home']);\r\n  }\r\n}\r\n"],"mappings":";AAAA,SAASA,SAAS,QAAgB,eAAe;AAU1C,IAAMC,cAAc,GAApB,MAAMA,cAAc;EASzBC,YACUC,WAAwB,EACxBC,WAAwB,EACxBC,MAAc;IAFd,KAAAF,WAAW,GAAXA,WAAW;IACX,KAAAC,WAAW,GAAXA,WAAW;IACX,KAAAC,MAAM,GAANA,MAAM;IAXhB,KAAAC,KAAK,GAAU,EAAE;IACjB,KAAAC,aAAa,GAAU,EAAE;IACzB,KAAAC,WAAW,GAAW,EAAE;IACxB,KAAAC,OAAO,GAAY,IAAI;IACvB,KAAAC,SAAS,GAAY,KAAK;IAC1B,KAAAC,YAAY,GAAW,EAAE;IACzB,KAAAC,cAAc,GAAW,EAAE;EAMxB;EAEHC,QAAQA,CAAA;IACN,IAAI,CAACC,SAAS,EAAE;EAClB;EAEAA,SAASA,CAAA;IACP,IAAI,CAACX,WAAW,CAACY,WAAW,EAAE,CAACC,SAAS,CACrCC,QAAa,IAAI;MAChB,IAAI,CAACX,KAAK,GAAGW,QAAQ,CAACX,KAAK,IAAIW,QAAQ;MACvC,IAAI,CAACV,aAAa,GAAG,IAAI,CAACD,KAAK;MAC/B,IAAI,CAACG,OAAO,GAAG,KAAK;IACtB,CAAC,EACAS,KAAU,IAAI;MACbC,OAAO,CAACC,GAAG,CAAC,yBAAyB,EAAEF,KAAK,CAAC;MAC7C,IAAI,CAACP,YAAY,GAAGO,KAAK,CAACA,KAAK,CAACG,OAAO,IAAI,6BAA6B;MACxE,IAAI,CAACZ,OAAO,GAAG,KAAK;IACtB,CAAC,CACF;EACH;EAEAa,WAAWA,CAAA;IACT,IAAI,CAAC,IAAI,CAACd,WAAW,CAACe,IAAI,EAAE,EAAE;MAC5B,IAAI,CAAChB,aAAa,GAAG,IAAI,CAACD,KAAK;MAC/B;;IAGF,MAAMkB,KAAK,GAAG,IAAI,CAAChB,WAAW,CAACiB,WAAW,EAAE;IAC5C,IAAI,CAAClB,aAAa,GAAG,IAAI,CAACD,KAAK,CAACoB,MAAM,CAACC,IAAI,IACzCA,IAAI,CAACC,KAAK,CAACH,WAAW,EAAE,CAACI,QAAQ,CAACL,KAAK,CAAC,IACxCG,IAAI,CAACG,MAAM,CAACL,WAAW,EAAE,CAACI,QAAQ,CAACL,KAAK,CAAC,CAC1C;EACH;EAEAO,UAAUA,CAACC,MAAc;IACvB,IAAI,CAACtB,SAAS,GAAG,IAAI;IACrB,IAAI,CAACC,YAAY,GAAG,EAAE;IACtB,IAAI,CAACC,cAAc,GAAG,EAAE;IAExB,IAAI,CAACR,WAAW,CAAC6B,UAAU,CAACD,MAAM,CAAC,CAAChB,SAAS,CAC1CC,QAAa,IAAI;MAChB,IAAI,CAACP,SAAS,GAAG,KAAK;MACtB,IAAI,CAACE,cAAc,GAAG,iCAAiC;MACvDsB,UAAU,CAAC,MAAK;QACd,IAAI,CAACpB,SAAS,EAAE;QAChB,IAAI,CAACF,cAAc,GAAG,EAAE;MAC1B,CAAC,EAAE,IAAI,CAAC;IACV,CAAC,EACAM,KAAU,IAAI;MACb,IAAI,CAACR,SAAS,GAAG,KAAK;MACtB,IAAI,CAACC,YAAY,GAAGO,KAAK,CAACA,KAAK,CAACG,OAAO,IAAI,6BAA6B;IAC1E,CAAC,CACF;EACH;EAEAc,MAAMA,CAAA;IACJ,IAAI,CAAC9B,MAAM,CAAC+B,QAAQ,CAAC,CAAC,OAAO,CAAC,CAAC;EACjC;CACD;AAvEYnC,cAAc,GAAAoC,UAAA,EAL1BrC,SAAS,CAAC;EACTsC,QAAQ,EAAE,WAAW;EACrBC,WAAW,EAAE,wBAAwB;EACrCC,SAAS,EAAE,CAAC,uBAAuB;CACpC,CAAC,C,EACWvC,cAAc,CAuE1B","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}